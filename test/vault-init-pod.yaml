apiVersion: v1
kind: Pod
metadata:
  name: vault-init
spec:
  serviceAccount: vault
  restartPolicy: Never
  containers:
  - name: vault-initializer
    image: ameypar/k8s-vault-initializer
    imagePullPolicy: Never
    env:
      - name: VAULT_ADDR
        value: https://vault-0.default.svc:8300
      - name: VAULT_CACERT
        value: /vault-tls/tls.crt
    volumeMounts:
      - name: vault-tls
        path: /vault-tls
  volumes:
    - name: vault-tls
      secret: vault-internal-tls-secret
